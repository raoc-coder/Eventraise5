"use strict";(()=>{var e={};e.id=565,e.ids=[565],e.modules={517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},2081:e=>{e.exports=require("child_process")},6113:e=>{e.exports=require("crypto")},2361:e=>{e.exports=require("events")},3685:e=>{e.exports=require("http")},5687:e=>{e.exports=require("https")},5477:e=>{e.exports=require("punycode")},2781:e=>{e.exports=require("stream")},7310:e=>{e.exports=require("url")},3837:e=>{e.exports=require("util")},9796:e=>{e.exports=require("zlib")},9073:(e,t,r)=>{r.r(t),r.d(t,{headerHooks:()=>_,originalPathname:()=>v,patchFetch:()=>E,requestAsyncStorage:()=>l,routeModule:()=>d,serverHooks:()=>h,staticGenerationAsyncStorage:()=>m,staticGenerationBailout:()=>I});var o={};r.r(o),r.d(o,{POST:()=>p});var s=r(5419),a=r(9108),n=r(9678),i=r(8070),u=r(5922),c=r(8234);async function p(e){try{let{amount:t,campaign_id:r,profile_id:o,donor_name:s,donor_email:a,currency:n="usd",success_url:p,cancel_url:d}=await e.json();if(!t||t<=0)return i.Z.json({error:"Invalid amount"},{status:400});if(!r)return i.Z.json({error:"Campaign ID is required"},{status:400});if(!c.O)return i.Z.json({error:"Database not configured"},{status:500});let{data:l,error:m}=await c.O.from("campaigns").select("title, description, goal_amount, current_amount").eq("id",r).single();if(m||!l)return i.Z.json({error:"Campaign not found"},{status:404});let h=await u.A.checkout.sessions.create({payment_method_types:["card"],line_items:[{price_data:{currency:n,product_data:{name:`Donation to ${l.title}`,description:l.description||"Thank you for your generous donation!"},unit_amount:Math.round(100*t)},quantity:1}],mode:"payment",success_url:p||"https://eventraise2.vercel.app/payment/success?session_id={CHECKOUT_SESSION_ID}",cancel_url:d||"https://eventraise2.vercel.app/payment/cancel",metadata:{campaign_id:r,profile_id:o||"",donor_name:s||"",donor_email:a||""},customer_email:a,billing_address_collection:"auto",allow_promotion_codes:!0});return i.Z.json({sessionId:h.id,sessionUrl:h.url})}catch(e){return console.error("Error creating checkout session:",e),i.Z.json({error:"Failed to create checkout session"},{status:500})}}let d=new s.AppRouteRouteModule({definition:{kind:a.x.APP_ROUTE,page:"/api/create-checkout/route",pathname:"/api/create-checkout",filename:"route",bundlePath:"app/api/create-checkout/route"},resolvedPagePath:"/Users/raoc/Documents/GitHub/Eventraise/app/api/create-checkout/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:l,staticGenerationAsyncStorage:m,serverHooks:h,headerHooks:_,staticGenerationBailout:I}=d,v="/api/create-checkout/route";function E(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:m})}},5922:(e,t,r)=>{r.d(t,{A:()=>o});let o=new(r(1211)).Z(process.env.STRIPE_SECRET_KEY,{apiVersion:"2023-10-16"})},8234:(e,t,r)=>{r.d(t,{O:()=>n});var o=r(2409);let s="https://yxzypekwyuopbanroobr.supabase.co",a="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inl4enlwZWt3eXVvcGJhbnJvb2JyIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTg0NjI3NDksImV4cCI6MjA3NDAzODc0OX0.37JNu4brGevL3VDd9In3vxSFY49Jw6CtMZw5SZ6uaEA",n=s&&a?(0,o.eI)(s,a):null;s&&process.env.SUPABASE_SERVICE_ROLE_KEY&&(0,o.eI)(s,process.env.SUPABASE_SERVICE_ROLE_KEY,{auth:{autoRefreshToken:!1,persistSession:!1}})}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),o=t.X(0,[638,206,409,211],()=>r(9073));module.exports=o})();